clear
lj = m_lj; constant = m_constant;

ald.disp =...
    m_joe_read_data('/home/jason/disorder2/lj/ald/m1/16x/Data_fullBZ.xls');
ald.disp.freq_20x =...
    load('/home/jason/disorder2/lj/ald/m1/20x/Frequency.txt');
NUM_MODES = 12;
for ikpt = 1:size(ald.disp.freq_20x,1)
    ald.disp.freq_20x_convert(...
        (ikpt-1)*NUM_MODES+1:(ikpt)*NUM_MODES,1)...
        =...
        (lj.tau/constant.s2ps)*ald.disp.freq_20x(ikpt,:)';
end

%100
thesis.disp(1).tran =...
    load('/home/jason/disorder/matlab/book/thesis_prim_100_tran.txt');
thesis.disp(1).long =...
    load('/home/jason/disorder/matlab/book/thesis_prim_100_long.txt');
%111
thesis.disp(2).tran =...
    load('/home/jason/disorder/matlab/book/thesis_prim_111_tran.txt');
thesis.disp(2).long =...
    load('/home/jason/disorder/matlab/book/thesis_prim_111_long.txt');

%--------------------------------------------------------------------------
%poly fit, not so good
%--------------------------------------------------------------------------
p(1).p = polyfit(thesis.disp(1).tran(:,1),thesis.disp(1).tran(:,2),6);
p(2).p = polyfit(thesis.disp(1).long(:,1),thesis.disp(1).long(:,2),6);
subplot(3,1,1),...
plot(...
    thesis.disp(1).tran(:,1) , ...
    polyval(p(1).p, thesis.disp(1).tran(:,1) ),...
    thesis.disp(1).tran(:,1) , ...
    polyval( polyder(p(1).p) , thesis.disp(1).tran(:,1) )/(2.0*2.1427*1.023*0.955),...
    thesis.disp(1).long(:,1) , ...
    polyval(p(2).p, thesis.disp(1).long(:,1) ),...
    thesis.disp(1).long(:,1) , ...
    polyval( polyder(p(2).p) , thesis.disp(1).long(:,1) )/(2.0*2.1427*1.0133)...
    )
set(gca,'XDir','Reverse')
pause
p(3).p = polyfit(thesis.disp(2).tran(:,1),thesis.disp(2).tran(:,2),3);
p(4).p = polyfit(thesis.disp(2).long(:,1),thesis.disp(2).long(:,2),3);
%vg 3.171806771548880 6.688020170235731
subplot(3,1,2),...
plot(...
    thesis.disp(2).tran(:,1)/0.9, ...
    polyval(p(3).p, thesis.disp(2).tran(:,1) ),...
    thesis.disp(2).long(:,1)/0.9, ...
    polyval(p(4).p, thesis.disp(2).long(:,1) ),...
    thesis.disp(2).tran(:,1)/0.9, ...
    polyval( polyder(p(3).p) , thesis.disp(2).tran(:,1) )/(6.633233532934132*1.165245901639344)+0.2,...
    thesis.disp(2).long(:,1)/0.9, ...
    polyval( polyder(p(4).p) , thesis.disp(2).long(:,1) )/(6.633233532934132*1.078730158730159) +0.1 ...
    )
pause
%--------------------------------------------------------------------------
%dos
%--------------------------------------------------------------------------
%get Bw^2 from VC DOS file
[ald.disp.dosx ald.disp.dosy] = m_dos(ald.disp.freq_20x_convert, 28 , 1);
subplot(3,1,3),...
plot(...
    ald.disp.dosy,ald.disp.dosx,...
    ((1.35E-2)*ald.disp.dosx).^2,ald.disp.dosx)






ald.disp.dosy,ald.disp.dosx,...
    ((1.35E-2)*ald.disp.dosx).^2,ald.disp.dosx

m_book_lj_disp_dos_vg_prim_createfigure(...
    ald.disp.dosy,...
    ald.disp.dosx,...
    ((1.35E-2)*ald.disp.dosx).^2,...
    thesis.disp(2).tran(:,1)/0.9,...
    [...
    polyval(p(3).p, thesis.disp(2).tran(:,1) )*0.94 ...
    polyval(p(4).p, thesis.disp(2).long(:,1) )*0.94 ...
    (polyval( polyder(p(3).p) , thesis.disp(2).tran(:,1) )/(6.633233532934132*1.165245901639344)+0.2) ...
    (polyval( polyder(p(4).p) , thesis.disp(2).long(:,1) )/(6.633233532934132*1.078730158730159) +0.1) ...
    ],...
    thesis.disp(1).tran(:,1),...
    [...
    polyval(p(1).p, thesis.disp(1).tran(:,1) )*0.94 ...
    polyval( polyder(p(1).p) , thesis.disp(1).tran(:,1) )/(2.0*2.1427*1.023*0.955) ...
    polyval(p(2).p, thesis.disp(1).long(:,1) )*0.94 ...
    polyval( polyder(p(2).p) , thesis.disp(1).long(:,1) )/(2.0*2.1427*1.0133) ...
    ] ...
    )

pause















%-------------------------------------------------------------------------- 
%conv disp
%--------------------------------------------------------------------------   
% plot(...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
%     [3.05;extract(1).vel(1:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
%     [6.3; extract(1).vel(3:12:36,1); ...
%     extract(1).vel( (3*12)+9:12:end,1)  ],...
%     [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ]/8,...
%     [6.871;extract(2).vel(1:12:size(extract(2).freq,1),1) ],...
%     [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ]/8,...
%     [8.99; extract(2).vel(3:12:6*12,1); ...
%     extract(2).vel( (6*12)+5:12:end-12,1) ; 7.35  ]...
% )

pause


















%--------------------------------------------------------------------------
%gulp
%--------------------------------------------------------------------------

%predict from gulp
str_matlab = '/home/jason/disorder/matlab/';
str_main = '/home/jason/disorder/matlab/book/';
name = 'gulp_disp_lj_prim.tmp';
ALAT = 1.55*3.4/2; MASS=39.948; NUM_ATOMS_UCELL=1;

B=[-1 1 1;1 -1 1;1 1 -1];

% kpt(:,1:3) = ...
%     [...
%         0   0.0 0
%         0.1    0 0
%         0.2 0.0   0
%         0.3 0 0
%         0.4 0.0   0
%         0.5 0 0
%         0.6 0.0   0
%         0.7 0 0
%         0.8 0.0   0
%         0.9 0 0
%         1.0 0.0   0 ...
%     ];

kpt(:,1:3) = ...
    [...
        0   0.0 0.0 
        0.1 0.1 0.1  
        0.2 0.2 0.2 
        0.3 0.3 0.3
        0.4 0.4 0.4
        0.5 0.5 0.5
        0.6 0.6 0.6
        0.7 0.7 0.7
        0.8 0.8 0.8
        0.9 0.9 0.9
        1.0 1.0 1.0...
    ];

kpt = kpt/2

for ikpt=1:length(kpt)
    kpt(ikpt,:)
freq(ikpt).freq =...
    m_gulp_freq_lj(kpt(ikpt,:),NUM_ATOMS_UCELL,MASS,ALAT,str_main,str_matlab,name)
vel(ikpt).vel =...
    m_gulp_vel_lj_prim(kpt(ikpt,:),NUM_ATOMS_UCELL,MASS,ALAT,str_main,str_matlab,name)
pause
end










%--------------------------------------------------------------------------
%spline fit, not so good
%--------------------------------------------------------------------------
% pp(1).pp =...
%     spline(thesis.disp(1).tran(:,1),thesis.disp(1).tran(:,2));
% p_der(1).p_der =...
%     fnder(pp(1).pp,1);
% y_prime(1).y_prime = ...
%     ppval(p_der(1).p_der,thesis.disp(1).tran(:,1));
% 
% pp(2).pp =...
%     spline(thesis.disp(1).long(:,1),thesis.disp(1).long(:,2));
% p_der(2).p_der =...
%     fnder(pp(2).pp,1);
% y_prime(2).y_prime = ...
%     ppval(p_der(2).p_der,thesis.disp(1).long(:,1));
% 
% pp(3).pp =...
%     spline(thesis.disp(2).tran(:,1),thesis.disp(2).tran(:,2));
% p_der(3).p_der =...
%     fnder(pp(3).pp,1);
% y_prime(3).y_prime = ...
%     ppval(p_der(3).p_der,thesis.disp(2).tran(:,1));
% 
% pp(4).pp =...
%     spline(thesis.disp(2).long(:,1),thesis.disp(2).long(:,2));
% p_der(4).p_der =...
%     fnder(pp(4).pp,1);
% y_prime(4).y_prime = ...
%     ppval(p_der(4).p_der,thesis.disp(2).long(:,1));
% 
% subplot(2,1,1),...
% plot(...
%     thesis.disp(1).tran(:,1),...
%     thesis.disp(1).tran(:,2),...
%     thesis.disp(1).long(:,1),...
%     thesis.disp(1).long(:,2),...
%     thesis.disp(1).tran(:,1),...
%     y_prime(1).y_prime,...
%     thesis.disp(1).long(:,1),...
%     y_prime(2).y_prime ...
%     )
% subplot(2,1,2),...
% plot(...
%     thesis.disp(2).tran(:,1),...
%     thesis.disp(2).tran(:,2),...
%     thesis.disp(2).long(:,1),...
%     thesis.disp(2).long(:,2),...
%     thesis.disp(2).tran(:,1),...
%     y_prime(3).y_prime,...
%     thesis.disp(2).long(:,1),...
%     y_prime(4).y_prime ...
%     )






NUM_MODES = 12;
for ikpt = 1:size(ald.disp.freq_20x,1)
    ald.disp.freq_20x_convert(...
        (ikpt-1)*NUM_MODES+1:(ikpt)*NUM_MODES,1)...
        =...
        (lj.tau/constant.s2ps)*ald.disp.freq_20x(ikpt,:)';
end
%--------------------------------------------------------------------------
%dispersion
%--------------------------------------------------------------------------
loglog(ald.disp.freq,ald.disp.life,'.',...
    ald.disp.freq,(2*pi)./(ald.disp.freq))
pause
%--------------------------------------------------------------------------
%dos
%--------------------------------------------------------------------------
%get Bw^2 from VC DOS file
[ald.disp.dosx ald.disp.dosy] = m_dos(ald.disp.freq_20x_convert, 28 , 1);
plot(ald.disp.dosy,ald.disp.dosx)
pause
%--------------------------------------------------------------------------
%vg
%--------------------------------------------------------------------------
%111
I = find(...
    ald.disp.kpt(:,1) == ald.disp.kpt(:,2) & ...
    ald.disp.kpt(:,1) == ald.disp.kpt(:,3) & ...
    ald.disp.kpt(:,1) > 0 & ald.disp.kpt(:,2) > 0 & ald.disp.kpt(:,3) > 0 ...
    );
extract(1).kpt = flipdim(ald.disp.kpt(I,:),1);
extract(1).freq = flipdim(ald.disp.freq(I),1);
extract(1).vel = flipdim(ald.disp.vel(I,:),1);
%100
I = find(...
    ald.disp.kpt(:,1) > 0 & ...
    ald.disp.kpt(:,2) > -0.01 & ald.disp.kpt(:,2) < 0.01 & ...
    ald.disp.kpt(:,3) > -0.01 & ald.disp.kpt(:,3) < 0.01 ...
    );
extract(2).kpt = flipdim(ald.disp.kpt(I,:),1);
extract(2).freq = flipdim(ald.disp.freq(I),1);
extract(2).vel = flipdim(ald.disp.vel(I,:),1);
%000
I = find(...
    ald.disp.kpt(:,1) > -0.01 & ald.disp.kpt(:,1) < 0.01 & ...
    ald.disp.kpt(:,2) > -0.01 & ald.disp.kpt(:,2) < 0.01 & ...
    ald.disp.kpt(:,3) > -0.01 & ald.disp.kpt(:,3) < 0.01 ...
    );
extract(3).kpt = flipdim(ald.disp.kpt(I,:),1);
extract(3).freq = flipdim(ald.disp.freq(I),1);
extract(3).vel = flipdim(ald.disp.vel(I,:),1);

%--------------------------------------------------------------------------
%[111]
%--------------------------------------------------------------------------
%unsorted
% plot(...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(1:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(2:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(3:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(4:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(5:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(6:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(7:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(8:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(9:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(10:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(11:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(12:12:size(extract(1).freq,1),1) ]...
% )

% [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [ 0 ; 0 ; 0 ; 0 ; 0 ; 0 ; 0 ;  0 ; 0 ],...

%sorted
plot(...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 0 ; 2.284 ; 4.478 ; 6.495 ; 8.259 ; 9.701 ; 10.77 ;  11.43 ; 11.65 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 0 ; 4.759 ; 9.378 ; 13.71 ; 17.59 ; 20.84 ; 23.31 ;  24.85 ; 25.38 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 17.5 ; 17.29 ; 16.75 ; 15.91 ; 14.86 ; 13.72 ; 12.67 ;  11.92 ; 11.65 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 17.5 ; 17.66 ; 18.08 ; 18.26 ; 17.59 ; 15.86 ; 13.88 ;  12.28 ; 11.65 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 25.4526 ; 25.2 ; 24.52 ; 23.81 ; 23.66 ; 24.13 ; 24.75 ;  25.21 ; 25.38 ] ...
)

% %just acoustic
% plot(...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0;extract(1).freq(1:12:size(extract(1).freq,1),1) ],...
%     [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
%     [0; extract(1).freq(3:12:36,1); ...
%     extract(1).freq( (3*12)+9:12:end,1)  ] ...
% )

%--------------------------------------------------------------------------
%[100]
%--------------------------------------------------------------------------
%unsorted
plot(...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(1:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(2:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(3:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(4:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(5:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(6:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(7:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(8:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(9:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(10:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(11:12:size(extract(1).freq,1),1) ],...
    [0;extract(2).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [0;extract(2).freq(12:12:size(extract(1).freq,1),1) ]...
    )

[0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
    [ 0 ; 0 ; 0 ; 0 ; 0 ; 0 ; 0 ;  0 ; 0 ],...

%sorted
plot(...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 0 ; 1.729 ; 3.439 ; 5.115 ; 6.737 ; 8.292 ; 9.763 ;  11.14 ; 12.4 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 0 ; 2.268 ; 4.532 ; 6.782 ; 9.01 ; 11.2 ;  13.32 ; 15.36 ; 17.26 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 17.5 ; 17.39 ; 17.14 ; 16.73 ; 16.16 ; 15.43 ;  14.56 ; 13.55 ; 12.4 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 17.5 ; 17.47 ; 17.44 ; 17.41 ; 17.37 ; 17.32 ;  17.29 ; 17.26 ; 17.29 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 17.5 ; 17.57 ; 17.85 ; 18.3 ; 18.88 ; 19.57 ;  20.32 ; 21.1 ; 21.88 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 25.4526 ; 25.31 ; 24.9 ; 24.22 ; 23.27 ; 22.09 ;  20.68 ; 19.07 ; 17.29 ],...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ 25.4526 ; 25.39 ; 25.2 ; 24.89 ; 24.47 ; 23.95 ;  23.3 ; 22.63 ; 21.88 ] ...
    )



% %acoustic
% plot(...
%     [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ],...
%     [0;extract(2).freq(1:12:size(extract(2).freq,1),1) ],...
%     [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ],...
%     [0; extract(2).freq(3:12:6*12,1); ...
%     extract(2).freq( (6*12)+5:12:end,1)  ]...
%     )

%--------------------------------------------------------------------------



%--------------------------------------------------------------------------
%main plots
%--------------------------------------------------------------------------
subplot(4,1,1),...
    plot(...
        [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
        [0;extract(1).freq(1:12:size(extract(1).freq,1),1) ],...
        [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
        [0; extract(1).freq(3:12:36,1); ...
        extract(1).freq( (3*12)+9:12:end,1)  ]...
    )
    
subplot(4,1,2),...
    plot(...
        [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ],...
        [0;extract(2).freq(1:12:size(extract(2).freq,1),1) ],...
        [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ],...
        [0; extract(2).freq(3:12:6*12,1); ...
        extract(2).freq( (6*12)+5:12:end,1)  ]...
        )
    set(gca,'XDir','Reverse')
subplot(4,1,3),...
    plot(ald.disp.dosy,ald.disp.dosx)
subplot(4,1,4),...
    plot(...
        [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
        [3.05;extract(1).vel(1:12:size(extract(1).freq,1),1) ],...
        [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ],...
        [6.3; extract(1).vel(3:12:36,1); ...
        extract(1).vel( (3*12)+9:12:end,1)  ],...
        [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ],...
        [6.871;extract(2).vel(1:12:size(extract(2).freq,1),1) ],...
        [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ],...
        [9.0072; extract(2).vel(3:12:6*12,1); ...
        extract(2).vel( (6*12)+5:12:end-12,1) ; 7.45  ]...
    )

%alone
%--------------------------------------------------------------------------
subplot(2,1,1),...
    plot(...
        [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
        [0;extract(1).freq(1:12:size(extract(1).freq,1),1) ],...
        [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
        [0; extract(1).freq(3:12:36,1); ...
        extract(1).freq( (3*12)+9:12:end,1)  ]...
    )
    
subplot(2,1,2),...
    plot(...
        [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ]/8,...
        [0;extract(2).freq(1:12:size(extract(2).freq,1),1) ],...
        [0;extract(2).kpt(1:12:size(extract(2).kpt,1),1) ]/8,...
        [0; extract(2).freq(3:12:6*12,1); ...
        extract(2).freq( (6*12)+5:12:end,1)  ]...
        )
    set(gca,'XDir','Reverse')
    
m_book_lj_disp_createfigure(...
    [0;extract(1).kpt(1:12:size(extract(1).kpt,1),1) ]/8,...
    [ [0;extract(1).freq(1:12:size(extract(1).freq,1),1) ] ...
    [0; extract(1).freq(3:12:36,1); ...
        extract(1).freq( (3*12)+9:12:end,1)  ] ] ,...
    [ [0;extract(2).freq(1:12:size(extract(2).freq,1),1) ] ...
    [0; extract(2).freq(3:12:6*12,1); ...
        extract(2).freq( (6*12)+5:12:end,1)  ] ] ...
    )
    
    
%-------------------------------------------------------------------------- 
% loglog(...
%     ald.disp.dosy,ald.disp.dosx,...
%     ((1.35E-2)*ald.disp.dosx).^2,ald.disp.dosx) 
plot(...
    ald.disp.dosy,ald.disp.dosx,...
    ((1.35E-2)*ald.disp.dosx).^2,ald.disp.dosx)

m_book_lj_dos_createfigure(...
    ald.disp.dosy,...
    ald.disp.dosx,...
    ((1.35E-2)*ald.disp.dosx).^2 ...
    )


