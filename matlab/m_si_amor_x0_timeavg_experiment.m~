clear

lj = m_lj; constant = m_constant;

str.main =...
    '/home/jason/disorder2/si/amor/prepare/4x/timeavg/';

x0(1).x0 =...
    m_x0_read([str.main 'x0.data']);
x0(1).freq =...
    load([str.main 'AF_freq.dat']);
x0(1).eigvec =...
    load([str.main 'AF_eigvec.dat']);

icnt = 1;
data(icnt).data =...
    m_lmp_readdump_all([str.main 'lmp.x.dump']);
log(icnt).log =...
    m_lmp_readlog([str.main 'log.lammps']);
array(icnt).array = str2num(log(icnt).log.data{3});



for idump = 2:size(data(1).data.atom_data,3)
    idump
plot3(...
    data(1).data.atom_data(:,1,idump),...
    data(1).data.atom_data(:,2,idump),...
    data(1).data.atom_data(:,3,idump),'.'...
    )
plot(...
    data(1).data.atom_data(:,1,idump),...
    data(1).data.atom_data(:,3,idump),'.'...
    )
axis([0 21.156 0 21.156])
%--------------------------------------------------------------------------
pause
%--------------------------------------------------------------------------
% plot3(...
%     data.atom_data(:,1,idump-1) - data.atom_data(:,1,idump),...
%     data.atom_data(:,2,idump-1) - data.atom_data(:,2,idump),...
%     data.atom_data(:,3,idump-1) - data.atom_data(:,3,idump),'.'...
%     )
% %--------------------------------------------------------------------------
% pause
% %--------------------------------------------------------------------------
end

T = 0.1;
urms(1).urms = m_lj_rms(T , x0(1).x0.m , x0(1).freq , x0(1).eigvec , 1 , size(x0(1).x0.x,1) );
urms(1).urms_md = mean(sqrt(array(1).array(:,8)));

